nameOverride: ""
fullnameOverride: ""

image:
  registry: "gcr.io"
  repository: "spiffe-io/spire-agent"
  tag: "1.0.0"

config: |
  agent {
    allow_unauthenticated_verifiers = false
    data_dir = "/run/spire/data"
    insecure_bootstrap = false
    log_level = "DEBUG"
    log_format = "json"
    server_address = "spire-server"
    server_port = "8081"
    socket_path = "/run/spire/sockets/agent.sock"
    trust_bundle_path = "/run/spire/bootstrap/trust-bundle.crt"
    trust_domain = "example.org"
  }

  plugins {
    NodeAttestor "k8s_psat" {
      plugin_data {
        cluster = "demo-cluster"
        token_path = "/var/run/secrets/tokens/spire-agent"
      }
    }

    KeyManager "memory" {
      plugin_data {
      }
    }

    WorkloadAttestor "k8s" {
      plugin_data {
      }
    }

    WorkloadAttestor "unix" {
      plugin_data {
      }
    }
  }

  health_checks {
    listener_enabled = true
    bind_address = "0.0.0.0"
    bind_port = "8080"
    live_path = "/live"
    ready_path = "/ready"
  }